{"version":3,"file":"infinitegrid.umd.js","sources":["../src/consts.ts","../src/utils.ts","../src/InfiniteGrid.tsx","../src/grids/MasonryInfiniteGrid.tsx","../src/grids/JustifiedInfiniteGrid.tsx","../src/grids/FrameInfiniteGrid.tsx","../src/grids/PackingInfiniteGrid.tsx"],"sourcesContent":["\nexport const REACT_INFINITEGRID_EVENT_MAP = {\n  \"onContentError\": \"contentError\",\n  \"onRenderComplete\": \"renderComplete\",\n  \"onRequestAppend\": \"requestAppend\",\n  \"onRequestPrepend\": \"requestPrepend\",\n  \"onChangeScroll\": \"changeScroll\",\n} as const;\n\nexport const REACT_INFINITEGRID_EVENTS: string[] = [];\n\nfor (const name in REACT_INFINITEGRID_EVENT_MAP) {\n  REACT_INFINITEGRID_EVENTS.push(name);\n}\n\nexport const REACT_INFINITEGRID_PROPS = [\n  \"tag\",\n  \"placeholder\",\n  \"status\",\n  \"useFirstRender\",\n  \"loading\",\n  \"itemBy\",\n  \"groupBy\",\n  ...REACT_INFINITEGRID_EVENTS,\n];\n","export function isFunction(val: any): val is Function {\n  return typeof val === \"function\";\n}\n","/**\n * egjs-infinitegrid\n * Copyright (c) 2021-present NAVER Corp.\n * MIT license\n */\nimport * as React from \"react\";\nimport VanillaInfiniteGrid, {\n  InfiniteGridOptions, InfiniteGridFunction,\n  Renderer,\n  InfiniteGridItemInfo,\n  ITEM_TYPE,\n  InfiniteGridMethods,\n  withInfiniteGridMethods,\n  getRenderingItems,\n  mountRenderingItems,\n} from \"@egjs/infinitegrid\";\nimport { ReactInfiniteGridProps } from \"./types\";\nimport { REACT_INFINITEGRID_PROPS, REACT_INFINITEGRID_EVENT_MAP } from \"./consts\";\nimport { isFunction } from \"./utils\";\n\nexport abstract class InfiniteGrid<T extends InfiniteGridOptions>\n  extends React.Component<T & ReactInfiniteGridProps & { [key: string]: any }> {\n  public static GridClass: InfiniteGridFunction;\n  @withInfiniteGridMethods\n  private _grid!: VanillaInfiniteGrid;\n  private _wrapperRef = React.createRef<HTMLDivElement>();\n  private _containerRef = React.createRef<HTMLDivElement>();\n  private _renderer!: Renderer;\n\n  public render() {\n    const attributes: { [key: string]: any } = {};\n    const props = this.props;\n    const GridClass = (this.constructor as typeof InfiniteGrid).GridClass;\n    const defaultOptions = GridClass.defaultOptions;\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const Tag = props.tag as any || \"div\";\n\n    for (const name in props) {\n      if (name in defaultOptions || REACT_INFINITEGRID_PROPS.indexOf(name as any) > -1) {\n        continue;\n      }\n      attributes[name] = props[name];\n    }\n\n    return <Tag ref={this._wrapperRef} {...attributes}>\n      {this._renderContainer()}\n    </Tag>;\n  }\n  public componentDidMount() {\n    const GridClass = (this.constructor as typeof InfiniteGrid).GridClass;\n    const defaultOptions = GridClass.defaultOptions;\n    const options: Partial<InfiniteGridOptions> = {};\n    const props = this.props;\n    const containerElement = this._containerRef.current;\n\n    for (const name in defaultOptions) {\n      if (name in props) {\n        (options as any)[name] = (props as any)[name];\n      }\n    }\n    if (containerElement) {\n      options.container = containerElement;\n    }\n    this._renderer = new Renderer();\n    options.renderer = this._renderer;\n    const grid = new GridClass(this._wrapperRef.current!, options);\n\n    for (const eventName in REACT_INFINITEGRID_EVENT_MAP) {\n      const nativeEventName = (REACT_INFINITEGRID_EVENT_MAP as any)[eventName];\n\n      grid.on(nativeEventName, (e: any) => {\n        const callback = this.props[eventName];\n\n        callback && callback(e);\n      });\n    }\n\n    this._grid = grid;\n    this._renderer.on(\"update\", () => {\n      this.setState({});\n    });\n\n    mountRenderingItems(this._getItemInfos(), {\n      grid,\n      useFirstRender: props.useFirstRender,\n      useLoading: props.loading,\n      usePlaceholder: props.placeholder,\n      horizontal: props.horizontal,\n      status: props.status,\n    });\n    this._renderer.updated();\n  }\n\n  public componentDidUpdate() {\n    const GridClass = (this.constructor as typeof InfiniteGrid).GridClass;\n    const propertyTypes = GridClass.propertyTypes;\n    const props = this.props;\n    const grid = this._grid;\n\n    for (const name in propertyTypes) {\n      if (name in props) {\n        (grid as any)[name] = (props as any)[name];\n      }\n    }\n    this._renderer.updated();\n  }\n\n  public componentWillUnmount() {\n    this._grid.destroy();\n  }\n\n  private _getItemInfos(): InfiniteGridItemInfo[] {\n    const props = this.props;\n    const children = React.Children.toArray(props.children) as React.ReactElement[];\n    const attributePrefix = props.attributePrefix || VanillaInfiniteGrid.defaultOptions.attributePrefix;\n    const itemBy = props.itemBy || ((item: React.ReactElement) => item.key);\n    const groupBy = props.groupBy || ((item: React.ReactElement) => item.props[`${attributePrefix}groupkey`]);\n    const infoBy = props.infoBy || (() => ({}));\n\n    \n    return children.map((child, i) => {\n      const {\n        data,\n        ...rest\n      } = infoBy(child, i) || {};\n\n      \n      return {\n        groupKey: groupBy(child, i),\n        key: itemBy(child, i),\n        ...rest,\n        data: {\n          ...data,\n          jsx: child,\n        },\n      };\n    });\n  }\n  private _renderContainer() {\n    const props = this.props;\n    const visibleChildren = this._getVisibleChildren();\n    const container = props.container;\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const ContainerTag = props.containerTag as any || \"div\";\n\n    if (container === true) {\n      return <ContainerTag ref={this._containerRef}>\n        {visibleChildren}\n      </ContainerTag>;\n    } else {\n      return visibleChildren;\n    }\n  }\n  private _getVisibleChildren() {\n    const props = this.props;\n    const placeholder = props.placeholder;\n    const loading = props.loading;\n    const visibleItems = getRenderingItems(this._getItemInfos(), {\n      grid: this._grid,\n      status: props.status,\n      horizontal: props.horizontal,\n      useFirstRender: props.useFirstRender,\n      useLoading: props.loading,\n      usePlaceholder: props.placeholder,\n    });\n\n    return visibleItems.map((item) => {\n      if (item.type === ITEM_TYPE.VIRTUAL) {\n        return React.cloneElement(isFunction(placeholder) ? placeholder(item) : placeholder, { key: item.key });\n      } else if (item.type === ITEM_TYPE.LOADING) {\n        return React.cloneElement(isFunction(loading) ? loading(item) : loading, { key: item.key });\n      } else {\n        return item.data.jsx;\n      }\n    });\n  }\n}\nexport interface InfiniteGrid<T extends InfiniteGridOptions> extends InfiniteGridMethods<InfiniteGrid<T>> { }\n","import {\n  MasonryInfiniteGrid as VanillaMasonryInfiniteGrid,\n  MasonryInfiniteGridOptions,\n} from \"@egjs/infinitegrid\";\nimport { InfiniteGrid } from \"../InfiniteGrid\";\n\nexport class MasonryInfiniteGrid extends InfiniteGrid<MasonryInfiniteGridOptions> {\n  public static GridClass = VanillaMasonryInfiniteGrid;\n}\n","import {\n  JustifiedInfiniteGrid as VanillaJustifiedInfiniteGrid,\n  JustifiedInfiniteGridOptions,\n} from \"@egjs/infinitegrid\";\nimport { InfiniteGrid } from \"../InfiniteGrid\";\n\nexport class JustifiedInfiniteGrid extends InfiniteGrid<JustifiedInfiniteGridOptions> {\n  public static GridClass = VanillaJustifiedInfiniteGrid;\n}\n","import {\n  FrameInfiniteGrid as VanillaFrameInfiniteGrid,\n  FrameInfiniteGridOptions,\n} from \"@egjs/infinitegrid\";\nimport { InfiniteGrid } from \"../InfiniteGrid\";\n\nexport class FrameInfiniteGrid extends InfiniteGrid<FrameInfiniteGridOptions> {\n  public static GridClass = VanillaFrameInfiniteGrid;\n}\n","import {\n  PackingInfiniteGrid as VanillaPackingInfiniteGrid,\n  PackingInfiniteGridOptions,\n} from \"@egjs/infinitegrid\";\nimport { InfiniteGrid } from \"../InfiniteGrid\";\n\nexport class PackingInfiniteGrid extends InfiniteGrid<PackingInfiniteGridOptions> {\n  public static GridClass = VanillaPackingInfiniteGrid;\n}\n"],"names":["REACT_INFINITEGRID_EVENT_MAP","REACT_INFINITEGRID_EVENTS","name","push","REACT_INFINITEGRID_PROPS","isFunction","val","__extends","_this","React","__proto","InfiniteGrid","prototype","attributes","props","GridClass","constructor","defaultOptions","Tag","tag","indexOf","ref","_wrapperRef","_renderContainer","options","containerElement","_containerRef","current","container","_renderer","Renderer","renderer","grid","eventName","nativeEventName","on","e","callback","_grid","setState","mountRenderingItems","_getItemInfos","useFirstRender","useLoading","loading","usePlaceholder","placeholder","horizontal","status","updated","propertyTypes","destroy","children","toArray","attributePrefix","VanillaInfiniteGrid","itemBy","item","key","groupBy","infoBy","map","child","i","_a","data","rest","groupKey","jsx","visibleChildren","_getVisibleChildren","ContainerTag","containerTag","visibleItems","getRenderingItems","type","ITEM_TYPE","VIRTUAL","LOADING","__decorate","withInfiniteGridMethods","MasonryInfiniteGrid","VanillaMasonryInfiniteGrid","JustifiedInfiniteGrid","VanillaJustifiedInfiniteGrid","FrameInfiniteGrid","VanillaFrameInfiniteGrid","PackingInfiniteGrid","VanillaPackingInfiniteGrid"],"mappings":"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"}